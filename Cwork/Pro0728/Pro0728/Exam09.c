#include<stdio.h>
#include<stdlib.h>
#define WIDTH 30
#define HEIGHT 30
static char map[HEIGHT][WIDTH] = {
		"------------oo----------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------"
};
static char map1[HEIGHT][WIDTH] = {
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------",
		"------------------------------"
};

void check(int i, int j) {
	int neighbor = 1;
	if (i > 0 && i < HEIGHT-1 && j > 0 && j < WIDTH-1) {
		if (map[i - 1][j - 1] == 'o')	neighbor++;
		if (map[i - 1][j] == 'o')		neighbor++;
		if (map[i - 1][j + 1] == 'o')	neighbor++;
		if (map[i][j - 1] == 'o')		neighbor++;
		if (map[i][j + 1] == 'o')		neighbor++;
		if (map[i + 1][j - 1] == 'o')	neighbor++;
		if (map[i + 1][j] == 'o')		neighbor++;
		if (map[i + 1][j + 1] == 'o')	neighbor++;
		if (neighbor >= 4 || neighbor < 2)		map1[i][j] = '-';
		else if (neighbor >= 2)					map1[i][j] = 'o';
	}
	else if (i == 0 && j == 0) {
		if (map[i][j + 1] == 'o' || map[i + 1][j] == 'o')	map1[i][j] = 'o';
		else												map1[i][j] = '-';
	}
	else if (i == 0 && j == WIDTH-1) {
		if (map[i][j - 1] == 'o' || map[i + 1][j] == 'o')	map1[i][j] = 'o';
		else												map1[i][j] = '-';
	}
	else if (i == HEIGHT-1 && j == 0) {
		if (map[i - 1][j] == 'o' || map[i][j + 1] == 'o')	map1[i][j] = 'o';
		else												map1[i][j] = '-';
	}
	else if (i == HEIGHT-1 && j == WIDTH-1) {
		if (map[i][j - 1] == 'o' || map[i - 1][j] == 'o')	map1[i][j] = 'o';
		else												map1[i][j] = '-';
	}
	else if (i == 0) {
		if (map[i][j - 1] == 'o')		neighbor++;
		if (map[i][j + 1] == 'o')		neighbor++;
		if (map[i + 1][j - 1] == 'o')	neighbor++;
		if (map[i + 1][j] == 'o')		neighbor++;
		if (map[i + 1][j + 1] == 'o')	neighbor++;
		if (neighbor >= 4 || neighbor < 2)		map1[i][j] = '-';
		else if (neighbor >= 2)					map1[i][j] = 'o';
	}
	else if (i == HEIGHT-1) {
		if (map[i - 1][j - 1] == 'o')	neighbor++;
		if (map[i - 1][j] == 'o')		neighbor++;
		if (map[i - 1][j + 1] == 'o')	neighbor++;
		if (map[i][j - 1] == 'o')		neighbor++;
		if (map[i][j + 1] == 'o')		neighbor++;
		if (neighbor >= 4 || neighbor < 2)		map1[i][j] = '-';
		else if (neighbor >= 2)					map1[i][j] = 'o';
	}
	else if (j == 0) {
		if (map[i - 1][j] == 'o')		neighbor++;
		if (map[i - 1][j + 1] == 'o')	neighbor++;
		if (map[i][j + 1] == 'o')		neighbor++;
		if (map[i + 1][j] == 'o')		neighbor++;
		if (map[i + 1][j + 1] == 'o')	neighbor++;
		if (neighbor >= 4 || neighbor < 2)		map1[i][j] = '-';
		else if (neighbor >= 2)					map1[i][j] = 'o';
	}
	else if (j == WIDTH-1) {
		if (map[i - 1][j - 1] == 'o')	neighbor++;
		if (map[i - 1][j] == 'o')		neighbor++;
		if (map[i][j - 1] == 'o')		neighbor++;
		if (map[i + 1][j - 1] == 'o')	neighbor++;
		if (map[i + 1][j] == 'o')		neighbor++;
		if (neighbor >= 4 || neighbor < 2)		map1[i][j] = '-';
		else if (neighbor >= 2)					map1[i][j] = 'o';
	}

}

void change() {
	for (int i = 0; i < HEIGHT; i++) {
		for (int j = 0; j < WIDTH; j++) {
			map[i][j] = map1[i][j];
		}
	}
}

void run() {
	
	while (1) {
		printf("종료하시려면 'Ctrl + C'를 입력하세요\n");
		for (int i = 0; i < HEIGHT; i++) {
			for (int j = 0; j < WIDTH; j++) {
				printf("%c", map[i][j]);
			}
			printf("\n");
		}
		for (int i = 0; i < HEIGHT; i++) {
			for (int j = 0; j < WIDTH; j++) {
				check(i, j);
			}
		}
		change();
		_sleep(500);
		system("cls");
	}
}

int main() {
	printf("\n9번 문제\n");
	printf("생명게임을 시작합니다.\n");
	run();
	printf("종료합니다\n");
	return 0;
}